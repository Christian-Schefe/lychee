module generic_test;
module enum_test;
module std;

import generic_test::{createStruct, test, MyStructIntInt, MyStruct};
import std::arrays::*;
import std::print::*;

int main() {
    let Test arr = createArray::<int>(100);
    arr.fill::<int>(10);
    arr.set::<int>(8, generic_sizeof_test::<MyStruct<char, long>, int>());
    for (let int i = 0; i < 5; i++) {
        arr.set::<int>(i, i);
        continue.unit_test(break);
        arr.set::<int>(i, i + 50);
    };
    arr.print();
    let MyStructIntInt my_struct = createStruct::<int, int>(10, 20, 30);
    std::io::file_test();
    generic_sizeof_test::<int>();

    let TestEnum test_enum = TestEnum::A;
    (TestEnum::D as int).println();
    println(TestEnum::D == TestEnum::B);
    println("hi");
    (TestEnum::E as int).print();
    enum_test::enum_test();
    println("END TEST");
    let (int) -> int test_fn = mul2;
    let int a = {test_fn}(10);
    a.println();
    test_fn(10).println();
    call_test_fn(test_fn, 10).println();
    println("END TEST 2");
    test() + arr.get::<int>(9)
}

enum TestEnum {
    A,
    B,
    C = 100,
    D = 1,
    E = -240,
}

alias Test = Array<int>;

int generic_sizeof_test<T>() {
    sizeof(T)
}

int generic_sizeof_test<T, K>() {
    sizeof(T) * sizeof(K)
}

unit unit_test(unit a, unit b) {
    a
}

int mul2(int a) {
    a * 2
}

int call_test_fn((int) -> int fn, int val) {
    fn(val)
}